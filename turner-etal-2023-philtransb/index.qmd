---
editor: 
  markdown: 
    wrap: 72
author: Matt Turner
title: "Prominent minority groups and high-transience majority groups promote
diffusion of adaptations"
bibliography: /Users/mt/workspace/Writing/library.bib
---

Communities most affected by climate change deserve to be included in promoting
sustainable adaptive behavior. In the South Pacific Island nations,
Indigenous peoples may be a minority in terms of population size, but they
could have a great impact on climate change adaptation. Indigenous peoples in a
place have been adapting to a changing climate for possibly thousands of
years. 

In 2023 some colleagues and I developed an agent-based model of adaptation
diffusion in a model population composed of a minority group and a majority
group and analyzed how the *asymmetric homophily* of each group 
be promoted by harnessing minority knowledge of adaptive behaviors at the outset
of some hypothetical intervention, while majority groups could support
adaptation by rapid spread in tight-knit communities [@Turner2023]. 

```{r, setup}

```

## Model setup

First, define a function to create a new *minority-majority* model as we'll call it:

```{r}
#' Create a new minority-majority adaptation diffusion model initialized as specified.
make_minmaj_model <- function(n_agents = 100, minority_fraction = 0.05,
                              mean_degree = 4, homophily = c(0.0),
                              social_learning_strategy = 
                                socmod::success_bias_learning_strategy,
                              adaptive_fitness = 1.4, 
                              start_group = "Minority") {
  
  # Minority groups are defined by the population size in this model.
  minority_size <- ceiling(n_agents * minority_fraction)
  majority_size <- n_agents - minority_size
  
  graph <- socmod::make_homophily_network(
    group_sizes = c(
      minority_size,
      majority_size
    ),
    mean_degree = mean_degree,
    homophily = homophily,
    add_to_complete = TRUE
  )
  
  # Initialize ABM.
  abm <- socmod::make_abm(socmod::make_model_parameters(graph = graph))
  
  # It might have already synced the group information as a parameter, let's see.
  # If not I'll have to write that.
  return (abm)
}
```

Then let's create one model:

```{r}
# Let's try making and running one zero-homophily model with 100 agents.
abm <- make_minmaj_model(
  n_agents = 100,
  homophily = 0.8,
  adaptive_fitness = 1.4,
  minority_fraction = 0.05  # means 5 in the minority group.
)
```


### Homphily network

We can visualize the homophily network using the following recipe:

```{r}
#| fig-asp: 0.8
#| column: margin

# Extract network.
net <- abm$get_network()

# Visualize groups and network.
socmod::ggnetplot(net, layout = \(net) 0.6*igraph::layout_in_circle(net)) +
  ggnetwork::geom_edges(linewidth = 0.25, color="darkgray") +
  ggnetwork::geom_nodes(ggplot2::aes(color = group), size = 3) +
  ggnetwork::theme_blank(base_size=25)
```

We see that at a homophily of 0.8 many of the network connections go between members of the majority group, group 2, since the majority accounts for 95% of the population and 90% of its edges connect two majority group members. 